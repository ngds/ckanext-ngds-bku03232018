ngds.Map={initialize:function(){var j="https://eia-ms.esri.com/arcgis/rest/services/20130301StateEnergyProfilesMap/MapServer/export";var b="https://eia-ms.esri.com/arcgis/rest/services/20130301StateEnergyProfilesMap/MapServer/export";var k="https://eia-ms.esri.com/arcgis/rest/services/20130301StateEnergyProfilesMap/MapServer/export";var y="https://eia-ms.esri.com/arcgis/rest/services/20130301StateEnergyProfilesMap/MapServer/export";var m="https://gis.srh.noaa.gov/ArcGIS/rest/services/RIDGERadar/MapServer/export";var e="http://services.arcgisonline.com/ArcGIS/rest/services/Specialty/Soil_Survey_Map/MapServer/";var h="http://basemap.nationalmap.gov/ArcGIS/rest/services/USGSTopo/MapServer/";var f=new L.TileLayer("http://{s}.maptile.maps.svc.ovi.com/maptiler/v2/maptile/newest/terrain.day/{z}/{x}/{y}/256/png8",{attribution:"Map &copy; <a href='http://developer.here.com'>Nokia</a>, Data &copy; NAVTEQ 2012"});var C=this.map=new L.Map("map-container",{layers:[f],center:new L.LatLng(34.1618,-100.53332),zoom:3,zoomControl:false});var s=L.Control.loading({separate:true,position:"topleft"});var q=new L.TileLayer.EsriImageExports(j,{layers:"42"});var i=new L.TileLayer.EsriImageExports(b,{layers:"36"});var t=new L.TileLayer.EsriImageExports(k,{layers:"1"});var d=new L.TileLayer.EsriImageExports(y,{layers:["21,22,26"]});var v=new L.TileLayer.EsriImageExports(m,{layers:"0"});var D=new L.tileLayer.wms("http://geo.cei.psu.edu:8080/geoserver/wms",{format:"image/png",transparent:true,attribution:"US Soil Survey",layers:"cei:canada,cei:mexicarib,cei:mlra_48,cei:lower48",styles:"other_polygons,other_polygons,llrShadeTest_opaque,state_noFill",srs:"srs:EPSG:102003"});var o=L.tileLayer.wms("http://geothermal.smu.edu/geoserver/wms",{layers:"wells",format:"image/png",transparent:true,attribution:"SMU Well Data"});var c=L.tileLayer.wms("http://www.geocommunicator.gov/arcgis/services/Basemaps/MapServer/WMSServer",{layers:"0,1,3,4,5,6,7,8,9,10,11,12,13,14,15",format:"image/png",transparent:true});var x=new L.TileLayer("http://basemap.nationalmap.gov/ArcGIS/rest/services/USGSTopo/MapServer/tile/{z}/{y}/{x}");var n=this.geoJSONLayer=new L.geoJson(null,{onEachFeature:function(F,E){}});var A=new L.Control.Draw({position:"topleft",polyline:false,circle:false,marker:false,polygon:false});C.addControl(A);var u=ngds.Map.drawnItems=new L.LayerGroup();C.addLayer(u);var w=ngds.Map.geosearch=new L.Control.GeoSearch({provider:new L.GeoSearch.Provider.OpenStreetMap(),position:"topright",searchLabel:"Locate an address"});w.addTo(C);var a=new ngds.Zoom({position:"topright"});var z=new L.Clear();C.addControl(z);var g=new L.FullScreen();C.addControl(a);if(g.is_fs_supported()===true){C.addControl(g)}C.addControl(s);this.layers={geojson:n,drawnItems:u,soil:D,land:c,topography:x,nerc:q,geothermal_potential:i,counties:t,weather:v};var B={Terrain:f,"US Topographic Map":x,"Soil Extent Map":D};overlayMaps={"Search Results":n,"SMU Wells":o,"USBLM Urban Areas, Counties":c,"NERC Regions":q,"Geothermal Potential":i,"US County Boundaries":t,"NEXRAD Weather":v};var l=ngds.Map.layer_control=new L.control.layers(B,overlayMaps,{autoZIndex:true});l.addTo(C);C.on("layeradd",function(E){try{n.bringToFront()}catch(F){}});copy=[];C.addLayer(n);var p=L.Icon.Label.extend({options:{iconUrl:"",shadowUrl:null,iconSize:new L.Point(36,36),iconAnchor:new L.Point(0,1),labelAnchor:new L.Point(0,0),wrapperAnchor:new L.Point(0,13),labelClassName:"placeMarks-label"}});var r=L.Icon.Label.extend({options:{iconUrl:"",shadowUrl:null,iconSize:new L.Point(36,36),iconAnchor:new L.Point(0,1),labelAnchor:new L.Point(5,5),wrapperAnchor:new L.Point(12,13),labelClassName:"placeMarks-label"}});placeMarker_triple=L.Icon.Label.extend({options:{iconUrl:"",shadowUrl:null,iconSize:new L.Point(25,41),iconAnchor:new L.Point(0,0),labelAnchor:new L.Point(0,0),wrapperAnchor:new L.Point(13,41),labelClassName:"placeMarks-label",popupAnchor:new L.Point(0,-33)}});ngds.publish("Map.loaded",{})},initialize_controls:function(){var b="";b+='<div id="map-expander">';b+="<p>&lt;&lt;</p>";b+="</div>";var c=false;var d=$("#map-container").css("width");var a="<p>&lt;&lt;</p>";var e="<p>&gt;&gt;</p>";$("#map-container").append(b);$("#map-expander").click(function(){if(c===false){c=true;$(".map-search").hide();$("#map-container").css("width",1024);$("#map-expander").empty();$("#map-expander").append(e);ngds.Map.map.invalidateSize()}else{c=false;$("#map-container").css("width",d);ngds.Map.map.invalidateSize();$(".map-search").show();$("#map-expander").empty();$("#map-expander").append(a)}return false})},zoom_managed_list:{},zoom_listeners:[],map_search:function(){var b=this;geoj=b.get_layer("drawnItems");var c=$("#map-query").val();var a=ngds.Pager(5);a.set_action(ngds.ckanlib.package_search,{q:c});if(ngds.Map.shape.str=="rect"){}else{}b.clear_layer("geojson");a.move(1,function(g,f){var e=ngds.Map.labeller.get_cur_label();ngds.Map.add_raw_result_to_geojson_layer(g,{iconimg_id:"lmarker-"+e});var d="0px";if(f==="marker"){$(".result-"+e).hover(function(){$(".lmarker-"+e).css("width","30px");$(".lmarker-"+e).css("height","45px");var h=$(".lmarker-"+e).next();h.css("font-size","14pt");h.css("margin-left","2px")},function(){$(".lmarker-"+e).css("width","25px");$(".lmarker-"+e).css("height","41px");var h=$(".lmarker-"+e).next();h.css("font-size","12.5pt");h.css("margin-left",d)});$(".result-"+e).click(function(){$(".result").css("background-color","#fff");var k=ngds.Map.state.colored_labels||(ngds.Map.state.colored_labels=[]);for(var j=0;j<k.length;j++){k[j].attr("src","/images/marker.png")}for(var h in ngds.Map.state.shapes_map){if(ngds.Map.state.shapes_map[h]!==null&&typeof ngds.Map.state.shapes_map[h]!=="undefined"){ngds.Map.state.shapes_map[h].setStyle({weight:ngds.Map.state.shapes_map[h].orig_weight,color:ngds.Map.state.shapes_map[h].orig_color})}}k=ngds.Map.state.colored_labels=[];$(".result-"+e).css("background-color","#dadada");$(".lmarker-"+e).attr("src","/images/marker-red.png");k.push($(".lmarker-"+e))})}else{$(".result-"+e).hover(function(){var h=ngds.Map.state.shapes_map[e];ngds.Map.state.shapes_map[e].prev_weight=ngds.Map.state.shapes_map[e].options.weight;ngds.Map.state.shapes_map[e].prev_color=ngds.Map.state.shapes_map[e].options.color;h.setStyle({weight:2,color:"#d54799"})},function(){var h=ngds.Map.state.shapes_map[e];h.setStyle({weight:ngds.Map.state.shapes_map[e].prev_weight,color:ngds.Map.state.shapes_map[e].prev_color})});$(".result-"+e).click(function(){$(".result").css("background-color","#fff");var l=ngds.Map.state.colored_labels||(ngds.Map.state.colored_labels=[]);for(var k=0;k<l.length;k++){l[k].attr("src","/images/marker.png")}for(var j in ngds.Map.state.shapes_map){if(ngds.Map.state.shapes_map[j]!==null&&typeof ngds.Map.state.shapes_map[j]!=="undefined"&&j!==e){ngds.Map.state.shapes_map[j].setStyle({weight:ngds.Map.state.shapes_map[j].orig_weight,color:ngds.Map.state.shapes_map[j].orig_color})}}$(".result-"+e).css("background-color","#dadada");var h=ngds.Map.state.shapes_map[e];if(h!==null&&typeof h!=="undefined"){h.setStyle({weight:3,color:"red"});ngds.Map.state.shapes_map[e].prev_weight=3;ngds.Map.state.shapes_map[e].prev_color="red"}})}},function(d){a.set_state(d,c)})},get_layer:function(a){if(a in this.layers){return this.layers[a]}throw"No layer exists with the key : "+a},add_to_layer:function(b,a){var c=this;if(a in this.layers&&b.length>0){$.each(b,function(d,e){e.addTo(c.layers[a])})}},clear_layer:function(a){this.layers[a].clearLayers()},add_packages_to_geojson_layer:function(b){var a=this;$.each(b,function(c,d){ngds.ckanlib.package_show(d,function(e){a.add_raw_result_to_geojson_layer(e.result)})})},add_raw_result_to_geojson_layer:function(b,d){try{var h=ngds.ckandataset(b);var f=h.getGeoJSON();var c=h.map.getPopupHTML()}catch(g){return}var a=L.geoJson(f,{style:{color:"black",weight:1,opacity:1,fillColor:"grey",fillOpacity:0.2},onEachFeature:function(l,j){var k=(function(m){if(m.feature.type=="Point"){return"Marker"}else{return"Feature"}})(j);ngds.Map.add_to_layer([j],"geojson");ngds.publish("Map.add_feature",{feature:j,seq_id:d.seq,type:k});if(j.feature.geometry.type==="Polygon"){ngds.Map.zoom_handler(j);var i=d.seq;var e=ngds.Map.state.shapes_map||(ngds.Map.state.shapes_map={});e[i]=j;e[i].orig_color="blue";e[i].orig_weight=2}},pointToLayer:function(i,j){var e=L.marker(j,{icon:new placeMarker_triple({iconUrl:"/images/marker.png",labelText:d.alph_seq,className:"lmarker-"+d.seq})});return e}});a.bindPopup(c);this.add_to_layer([a],"geojson");this.sort_geojson_layers(a);return a},sort_geojson_layers:function(d){var b=new ngds.Map.BoundingBox().store_raw(d.getBounds()).get_perimeter();if(typeof ngds.util.state.map_features==="undefined"){ngds.util.state.map_features=[]}var a=ngds.util.state.map_features;var c=0;for(c=0;c<=a.length;c++){if(c===a.length){break}if(typeof a[c]==="undefined"||a[c]===null){continue}if(b<new ngds.Map.BoundingBox().store_raw(a[c].getBounds()).get_perimeter()){break}}a.splice(c,0,d);for(var c=a.length-1;c>-1;c--){if(typeof a[c]==="undefined"||a[c]===null){continue}a[c].bringToFront()}},utils:{get_bound:function(coords,lat_or_lng,min_or_max){(function(){if(lat_or_lng!=="lat"&&lat_or_lng!=="lng"||min_or_max!=="min"&&min_or_max!=="max"){throw"Expected 'lat' or 'lng' for lat_or_lng and 'min' or 'max' for min_or_max"}})();var func=eval("Math."+min_or_max);var operands=[];$.each(coords,function(index,item){operands.push(item[lat_or_lng])});return func.apply(this,operands)}},register_map_query_provider:function(a){(function(){if(a===null||typeof a==="undefined"){throw"Expected a string for id_provider."}})();this.query_provider="#"+a},state:{},is_fullscreen:function(){if(typeof ngds.Map.state.fullscreen==="undefined"){return false}return ngds.Map.state.fullscreen}};